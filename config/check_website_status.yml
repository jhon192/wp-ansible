- name: Optimizar seguridad y logs Apache
  hosts: localhost
  become: yes
  gather_facts: yes

  vars:
    ansible_remote_tmp: "/tmp/.ansible-123324453"

  tasks:

  - name: Mostrar Ãºltimos 50 errores de cada sitio
    shell: tail -n 50 /home/semaphore/chipdomainforever46.store/logs/error.log
    register: site_errors
    ignore_errors: true

  - debug:
      msg: |
        ðŸ”´ Errores recientes en {{ item.item }}:
        {{ item.stdout_lines }}
    loop: "{{ site_errors.results }}"


  - name: check conf files
    command: cat /etc/apache2/sites-available/chipdomainforever46.store.conf
    register: conf_files
    changed_when: false

  - name: Mostrar archivos de configuraciÃ³n de Apache
    debug:
      msg: "{{ conf_files.stdout_lines }}"
    
