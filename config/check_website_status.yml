- name: Optimizar seguridad y logs Apache
  hosts: localhost
  become: yes
  gather_facts: yes

  vars:
    ansible_remote_tmp: "/tmp/.ansible-123324453"

  tasks:

  - name: Mostrar Ãºltimos 50 errores de cada sitio
    shell: tail -n 50 {{ item }}
    loop: "{{ lookup('fileglob', '/home/semaphore/skillburst.xyz/logs/error.log', wantlist=True) }}"
    register: site_errors
    ignore_errors: true

  - debug:
      msg: |
        ðŸ”´ Errores recientes en {{ item.item }}:
        {{ item.stdout_lines }}
    loop: "{{ site_errors.results }}"
    

  - name: mostrar index.php
    shell: cat /home/semaphore/skillburst.xyz/index.php
    register: index_content
  -  debug:
      msg: "Contenido de index.php:\n{{ index_content.stdout }}"
